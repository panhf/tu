<mxfile host="app.diagrams.net" modified="2023-02-07T07:24:24.166Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36" etag="w5BRrpHnpFdCJb9X-MUc" version="20.8.16" type="github">
  <diagram name="第 1 页" id="QcjsDPf29D6IuBX9PW6E">
    <mxGraphModel dx="1195" dy="627" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="KqO1XoUJhTVogDRzArD_-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-1" target="KqO1XoUJhTVogDRzArD_-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-5" value="1.其他逻辑，上传&lt;br&gt;自己A公钥" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-4">
          <mxGeometry x="-0.175" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.25;exitDx=0;exitDy=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-1" target="KqO1XoUJhTVogDRzArD_-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-16" value="3.加密消息内容发送，其中有发送端A的公钥信息" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-15">
          <mxGeometry x="-0.3385" relative="1" as="geometry">
            <mxPoint x="33" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-1" value="A端：&lt;br&gt;非对称加密&lt;br&gt;设备私钥+公钥&lt;br&gt;根据B公钥+A私钥加密（发送端，取用B公钥通过服务端or本地缓存）" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry y="20" width="140" height="200" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-67" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-2" target="KqO1XoUJhTVogDRzArD_-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-69" value="1.其他逻辑，上传&lt;br style=&quot;border-color: var(--border-color); font-size: 11px;&quot;&gt;&lt;span style=&quot;font-size: 11px;&quot;&gt;自己B公钥&lt;/span&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#330000;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-67">
          <mxGeometry x="0.1091" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-2" value="B端：&lt;br&gt;非对称加密&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;设备私钥+公钥.&lt;br&gt;根据A公钥+B私钥解密（接收端，获取A公钥，必然采用消息体公钥）" style="rounded=0;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="810" y="20" width="140" height="200" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-3" target="KqO1XoUJhTVogDRzArD_-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-14" value="2.通过服务端获取B的公钥" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-13">
          <mxGeometry x="0.4373" y="-2" relative="1" as="geometry">
            <mxPoint x="51" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-3" target="KqO1XoUJhTVogDRzArD_-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-18" value="3.转发到B" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-17">
          <mxGeometry x="-0.2837" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-3" value="服务端" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;" vertex="1" parent="1">
          <mxGeometry x="460" y="55" width="130" height="130" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-21" value="传输消息结构：&lt;br style=&quot;font-size: 12px;&quot;&gt;&lt;div&gt;{&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;fromAreaid&quot;:&quot;&quot;, //来源areaId&amp;nbsp; 暂不用字段50&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;fromGroupid&quot;:&quot;&quot;, //来源groupId&amp;nbsp; 群组&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;fromNumid&quot;:&quot;&quot;, //来源numId&lt;span style=&quot;white-space: pre;&quot;&gt;	&lt;/span&gt;人员&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;insertTime&quot;:&quot;&quot;, //插入时间&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;cursor&quot;:&quot;&quot;, //游标&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;type&quot;:&quot;&quot;,&amp;nbsp; //消息种类枚举&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;msg&quot;:&quot;&quot;,&amp;nbsp; //消息&lt;/div&gt;&lt;div&gt;&amp;nbsp; &quot;msgExt&quot;:{&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &quot;richText&quot;:{ // 具体展示数据&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;type&quot;:&quot;0&quot;,&amp;nbsp; // 消息展示类型，0-纯文本消息，1-链接消息，2-按钮卡片消息，3-列表消息&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;content&quot;:{&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;title&quot;:&quot;我是标题&quot;, // 标题，也会用于消息列表中内容展示，若不写则消息列表中内容取用`msg`字段&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &quot;info&quot;:&quot;我是内容&quot;, //文本内容，不写默认取最外层msg字段&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;&amp;nbsp; &amp;nbsp; }&lt;/div&gt;&lt;div&gt;发送端公钥：123456&lt;/div&gt;&lt;div&gt;&amp;nbsp; }, //消息扩展&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;" vertex="1" parent="1">
          <mxGeometry y="230" width="790" height="300" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-23" value="问题出现在服务端获取的B公钥不准确，存在延时" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontColor=#FF4D17;" vertex="1" parent="1">
          <mxGeometry x="180" y="185" width="280" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-25" value="离线模式下，消息在队列中存储，未消费。处于加密状态（发送端私钥+接收端公钥），当设备改变，通过接收端私钥无法解密" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="300" width="385" height="30" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-26" value="" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry y="540" width="1260" height="370" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-27" value="A1" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="20" y="585" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-28" value="A2&lt;br&gt;离线失败" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry y="685" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-29" value="A3" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="20" y="780" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-30" value="B1" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="640" y="555" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-35" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-31" target="KqO1XoUJhTVogDRzArD_-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-37" value="重新建立加密过程，重发消息，并且带上自己最新的B2公钥，返回离线" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-35">
          <mxGeometry x="0.3137" y="2" relative="1" as="geometry">
            <mxPoint x="58" y="-2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-48" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.25;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-31" target="KqO1XoUJhTVogDRzArD_-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-50" value="1.对其他端建立加密过程，重发" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-48">
          <mxGeometry x="-0.5421" y="-2" relative="1" as="geometry">
            <mxPoint x="-46" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-49" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-31" target="KqO1XoUJhTVogDRzArD_-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-51" value="1.对其他端建议加密过程，重发" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-49">
          <mxGeometry x="-0.4906" y="-2" relative="1" as="geometry">
            <mxPoint x="-30" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-31" target="KqO1XoUJhTVogDRzArD_-33">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-31" target="KqO1XoUJhTVogDRzArD_-33">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="630" y="660" />
              <mxPoint x="370" y="660" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-31" value="B2&lt;br&gt;B2私钥+A2公钥&lt;br&gt;解密失败" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="770" y="685" width="120" height="65" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-32" value="B3" style="rounded=0;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="630" y="840" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" target="KqO1XoUJhTVogDRzArD_-28">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="270" y="715" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-38" value="重新建立加密过程，失败" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-36">
          <mxGeometry x="0.2051" y="-2" relative="1" as="geometry">
            <mxPoint x="18" y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-33" target="KqO1XoUJhTVogDRzArD_-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-59" value="2.对自己同步端进行加密过程，请求重发，消息特殊处理，加字段" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-54">
          <mxGeometry x="0.1063" y="1" relative="1" as="geometry">
            <mxPoint x="-24" y="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-56" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=12;fontColor=#FF4D17;" edge="1" parent="1" source="KqO1XoUJhTVogDRzArD_-33" target="KqO1XoUJhTVogDRzArD_-30">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-57" value="2.对自己同步端进行加密过程，请求重发，消息特殊处理，加字段" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=12;fontColor=#FF4D17;" vertex="1" connectable="0" parent="KqO1XoUJhTVogDRzArD_-56">
          <mxGeometry x="-0.0597" y="2" relative="1" as="geometry">
            <mxPoint x="8" y="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-33" value="服务端" style="ellipse;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="270" y="675" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-62" value="" style="rounded=1;whiteSpace=wrap;html=1;strokeColor=default;fontSize=12;fontColor=#FF4D17;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="770" y="670" width="430" height="110" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-63" value="获取发送端的公钥+B2公钥解析重发的加密消息，&lt;br&gt;再次解密失败（再换手机，A2私钥错误），新手机循环" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=12;fontColor=#FF4D17;" vertex="1" parent="1">
          <mxGeometry x="900" y="675" width="310" height="40" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-70" value="&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;广播重发消息返回失败，再次广播最多3回。&lt;/span&gt;&lt;br style=&quot;border-color: var(--border-color); color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;&quot;&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: center; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(251, 251, 251); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial; float: none; display: inline !important;&quot;&gt;返回成功记录成功，记录umid去重消息更新数据库。&lt;br&gt;再次成功，umid去重&lt;br&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="900" y="715" width="340" height="50" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-71" value="其他场景：&lt;br&gt;1.“这是一条加密的消息，请在加密的设备端查看。”发送端没有获取到其中一个接收端的公钥的情况。（服务端获取、缓存获取）&lt;br&gt;2.明文消息，发送端没有获取所有的接收端的公钥的情况。（服务端获取、缓存获取）" style="text;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry y="1150" width="680" height="70" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-72" value="&lt;span data-copy-origin=&quot;https://doc.daqunchat.com&quot; data-docs-delta=&quot;[[20,&amp;quot;{&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;YNAS\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;  msgExt: {&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;Vgk3\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;    updateE2EECer: {&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;atrl\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;      areaId: xxx,&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;xfEq\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;      numId: xxx,&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;CnPP\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;      client: xxx,  // 请求消息重发的端&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;vK4W\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;      uMId: xxx,    // 请求重发的指定消息uMId&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;Q8HP\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;      newCerHash: xxx,  // 发送请求端此时的公钥hash&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;zw7l\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;    }&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;Pvve\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;  }&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;VP2J\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;}&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;nvir\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;]]&quot;&gt;&lt;pre&gt;1.重发消息体&lt;/pre&gt;&lt;pre&gt;{&lt;br&gt;  msgExt: {&lt;br&gt;    updateE2EECer: {&lt;br&gt;      areaId: xxx,&lt;br&gt;      numId: xxx,&lt;br&gt;      client: xxx,  // 请求消息重发的端&lt;br&gt;      uMId: xxx,    // 请求重发的指定消息uMId&lt;br&gt;      newCerHash: xxx,  // 发送请求端此时的公钥hash&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;}&lt;/pre&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry y="930" width="320" height="210" as="geometry" />
        </mxCell>
        <mxCell id="KqO1XoUJhTVogDRzArD_-73" value="&lt;span data-copy-origin=&quot;https://doc.daqunchat.com&quot; data-docs-delta=&quot;[[20,&amp;quot;{&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;Vws9\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;  msgExt: {&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;8DtW\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;    updateE2EECerBySelf: true,  // 只有24类型的消息，且消息接收者是自己才有这个字段&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;HbSw\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;  }&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;jUMK\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;],[20,&amp;quot;}&amp;quot;],[20,&amp;quot;\n&amp;quot;,&amp;quot;24:\&amp;quot;mmoD\&amp;quot;|36:177|direction:\&amp;quot;ltr\&amp;quot;&amp;quot;]]&quot;&gt;&lt;pre&gt;2.同步端重发消息体&lt;/pre&gt;&lt;pre&gt;{&lt;br&gt;  msgExt: {&lt;br&gt;    updateE2EECerBySelf: true,  // 只有24类型的消息，且消息接收者是自己才有这个字段&lt;br&gt;  }&lt;br&gt;}&lt;/pre&gt;&lt;/span&gt;" style="text;whiteSpace=wrap;html=1;fontSize=12;fontColor=#000000;strokeColor=default;" vertex="1" parent="1">
          <mxGeometry x="330" y="930" width="530" height="120" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
